<?xml version="1.0"?>
<launch>
    <arg name="id" default="1"/>
    <arg name="use_sim_time" default="false"/> <!-- Note that 'use_sim_time' param is global. All nodes in all launch files will use sim time if use_sim_time is set true in any launch file -->
    <arg name="local_pos_source" default="1"/> <!-- 0 is mocap/uwb, 1 is GPS -->
    <!-- 0: mavros/local_position/pose will output the world coordinates of the drone -->
    <!-- 1: mavros/local_position/pose will output the coordinates relative to the initial point or gp_origin which can be changed by mavros/globa_position/set_gp_origin -->
    <arg name="init_x_East_metre" default="1.0"/>
    <arg name="init_y_North_metre" default="0.0"/>
    <arg name="init_z_Up_metre" default="0.0"/>
    <arg name="mavros_sim_plugin_config_yaml" default="$(find px4_rotor_sim)/launch/mavros_px4_config.yaml"/>
    <arg name="px4_rotor_sim_param_config_yaml" default="$(find px4_rotor_sim)/launch/px4_rotor_sim_param.yaml"/>
    

    <param name="/use_sim_time" value="$(arg use_sim_time)"/>

    <node pkg="px4_rotor_sim" type="mavros_px4_quadrotor_sim_node" name="mavros_px4_quadrotor_sim_node_$(arg id)" output="screen">
    	<!-- load local position source -->
        <param name="local_pos_source" value="$(arg local_pos_source)"/>
        
        <!-- load init position -->
        <param name="init_x_East_metre" value="$(arg init_x_East_metre)"/>
        <param name="init_y_North_metre" value="$(arg init_y_North_metre)"/>
        <param name="init_z_Up_metre" value="$(arg init_z_Up_metre)"/>
        
        <!-- load mavros plugin config (Not mandatory ) -->
        <!-- rosparam command="load" file="$(arg mavros_sim_plugin_config_yaml)" /-->   
	
        <!-- load px4 param -->
        <rosparam command="load" file="$(arg px4_rotor_sim_param_config_yaml)" />     
    </node>

    <!-- for visualization -->
    <param name="robot_description" textfile="$(find px4_rotor_sim)/model/iris.urdf" />
    <!-- <node name="joint_state_publisher" pkg="joint_state_publisher" type="joint_state_publisher" /> -->  <!-- joint states and base_link TF published by drone_visualizer instance in mavros_px4_quadrotor_sim_node already -->
    <node name="robot_state_publisher" pkg="robot_state_publisher" type="robot_state_publisher" />
    <node name="rviz" pkg="rviz" type="rviz" args="-d $(find px4_rotor_sim)/launch/single_px4_rotor.rviz" required="true" />


</launch>
